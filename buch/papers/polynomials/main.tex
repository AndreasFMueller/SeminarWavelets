%
% main.tex -- Paper zum Thema Polynome
%
% (c) 2019 Hochschule Rapperswil
%
\chapter{Wavelets und polynomiale Signale\label{chapter:thema}}
\lhead{Wavelets und polynomiale Signale}
\begin{refsection}
\chapterauthor{Raphael Nestler}

In der Literatur zu Wavelets findet man die folgende Aussage zu Daubechies
Wavelets:
\begin{displayquote}[\cite{wikipedia:daubechies}]
For example, $D2$, with one vanishing moment, easily encodes polynomials of one
coefficient, or constant signal components. $D4$ encodes polynomials with two
coefficients, i.e.\ constant and linear signal components; and $D6$ encodes
3-polynomials, i.e.\ constant, linear and quadratic signal components.
\end{displayquote}
Ein Daubechies Wavelet mit $A$ verschwindenden Momenten und Filterlänge $N=2A$
soll also ein Polynom der Ordnung $A-1$ einfach darstellen können. Wir wollen
erörtern, was das nun in der Praxis genau bedeutet und welche Anwendungen es
ermöglicht.

Wir werden im folgenden Daubechies Wavelets mit $A$ verschwindenden Momenten mit
db$A$ bezeichnen.

Die Analysen und Simulationen wurden jeweils mittels Python~\cite{python} und im
speziellem dem PyWavelets~\cite{gregory_r_lee_2019_2634243} Paket durchgeführt.
Der dazu verwendete Code wurde in einem GitHub-Repository%
\footnote{\url{https://github.com/rnestler/mathsem-FS2019/tree/paper}}%
~\cite{polynomials:repo}
abgelegt. Zusätzlich sind auch interaktive Jupyter Notebooks abgelegt um den
Einfluss von verschiedenen Parametern auszuprobieren. Mittels
Binder%
\footnote{\url{https://mybinder.org/v2/gh/rnestler/mathsem-FS2019/paper}}%
~\cite{project_jupyter-proc-scipy-2018}%
kann eine online Umgebung gestartet werden um diese Beispiele auszuführen.

\section{Analyse von polynomialen Signalen}
\rhead{Polynomiale Signale}

Wir werden als erstes die Signale in \autoref{polynomials:signals} mittels des db1
(Haar) Wavelets analysieren.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_signals.pgf}
    \caption{Die verschiedenen zu analysierenden polynomialen Signale\label{polynomials:signals}}
\end{figure}

In~\autoref{polynomials:haar} sind die Approximations- und die Detailkoeffizienten
der Transformation zu sehen. Wir sehen, dass die Approximationskoeffizienten
uns das grobe Signal und im Fall von $x^0 = 1$ sogar das exakte Signal liefern. Die
Detailkoeffizienten scheinen uns etwas zu liefern was proportional zur ersten
Ableitung des Signals ist.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_signals_db1.pgf}
    \caption{Analyse mit db1 (Haar) Wavelet\label{polynomials:haar}}
\end{figure}

In \autoref{polynomials:diff} sind zum Vergleich die Ableitungen der
verschiedenen Signale geben.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_signals_diff.pgf}
    \caption{Ableitungen der Polynome\label{polynomials:diff}}
\end{figure}

Dieses Verhalten ist zu erwarten wenn man bedenkt, dass das Haar Wavelet
jeweils die Summe und die Differenz zweier benachbarter Samples analysiert.
Siehe dazu auch \autoref{haar:allwavelets:image} im Kapitel zum Haar Wavelet.

Nun stellt sich die Frage was passiert wenn wir Daubechies Wavelets mit mehr
verschwindenden Momenten zur Analyse einsetzen. In \autoref{polynomials:db2_3}
sind jeweils die Detailkoeffizienten der Analyse mit db1 und db2 Wavelet zu
sehen.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_signals_db2_3.pgf}
    \caption{Analyse mit db2/3 Wavelet\label{polynomials:db2_3}}
\end{figure}

Wie sich herausstellt liefern diese Wavelets jeweils die zweite und dritte
Ableitung unserer Signale. Daubechies Wavelets mit $A$ verschwindenden Momenten
können uns also direkt die $A$te Ableitung liefern. Dies im Gegensatz zum
Differenzieren welches mehrfach angewendet werden muss.

\section{Anwendung zur rauscharmen Ableitung}
\rhead{Rauscharme Ableitung}

Beim diskreten Ableiten (Differenzen) von Signalen stellt sich oftmals das
Problem, das Rauschen in dem Signal verstärkt wird. Anstelle der Ableitung des
interessanten Signals sehen wir also nur die zufällige Ableitung des Rauschens.
Dies wird nochmals verstärkt wenn ein Signal mehrfach abgeleitet werden soll.

\autoref{polynomials:noise:signals} zeigt unsere ursprünglichen polynomialen
Signale mit leichtem Rauschen versehen und die Ableitung davon. Wie erwartet
ist die Ableitung vom Rauschen dominiert und die Steigung des ursprünglichen
Polynoms ist kaum noch erkennbar.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_signals.pgf}
    \caption{Verrauschte Signale und deren Ableitung\label{polynomials:noise:signals}}
\end{figure}

Was passiert nun wenn wir das verrauschte Signale mit einem Haar Wavelet
analysieren?  Wie in \autoref{polynomials:noise:db1} zu sehen bringt das so
noch keine wesentliche Verbesserung zum direkten Ableiten.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_db1.pgf}
    \caption{Analyse verrauschter Signale mit Haar Wavelet\label{polynomials:noise:db1}}
\end{figure}

Nun können wir aber mit dem Wavelet eine Multiskalenanalyse durchführen. Im
Fall vom Haar Wavelet ist dies vergleichbar wie wenn zuerst der Mittelwert
gebildet und dann abgeleitet wird. 

In \autoref{polynomials:noise:db1_multi} ist das Signal $x^2 + r$, die
Detailkoeffizienten der verschiedenen Stufen der Multiskalenanalyse mit dem
Haar Wavelet und dann noch die Approximationskoeffizienten der letzten Stufe
abgebildet. Es ist zu sehen, dass die Detailkoeffizienten mit höherer Stufe
eher der Ableitung des originalen Polynoms entsprechen und weniger vom Rauschen
betroffen sind. Jedoch nimmt die zeitliche Auflösung ab.
Die Stufenbreite macht jeweils den zeitlichen Bereich, also die Anzahl Samples,
welcher für die Berechnung des jeweiligen Koeffizienten relevant ist sichtbar.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_db1_multi.pgf}
    \caption{Multiskalenanalyse von $x^2 + r$ mit Haar Wavelet\label{polynomials:noise:db1_multi}}
\end{figure}

Im Vergleich dazu sind in \autoref{polynomials:noise:average} die direkte
Ableitung und die Ableitungen nach der Mittelwertbildung über 2, 4 und 8 Werte
zu sehen.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_moving_average.pgf}
    \caption{Ableitung nach Mittelwertbildung\label{polynomials:noise:average}}
\end{figure}

Nun haben wir aber mit dem Verfahren mit den Wavelets den Vorteil, dass wir bei
entsprechender Wahl des Wavelets direkt die $A$te Ableitung berechnen können.

In \autoref{polynomials:noise:db2_multi} ist das Signal $x^3 + r$, die
Detailkoeffizienten der verschiedenen Stufen der Multiskalenanalyse mit dem db2
Wavelet und die Approximationskoeffizienten der letzten Stufe abgebildet.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_db2_multi.pgf}
    \caption{Multiskalenanalyse von $x^3 + r$ mit db2 Wavelet\label{polynomials:noise:db2_multi}}
\end{figure}

Im Vergleich dazu sind in \autoref{polynomials:noise:average} die direkt
berechnete zweite Ableitung und die zweite Ableitungen nach der
Mittelwertbildung über 2, 4 und 8 Werte zu sehen.

\begin{figure}
    \centering
    \input{papers/polynomials/images/polynomials_noise_moving_average_2nd.pgf}
    \caption{Zweite Ableitung nach Mittelwertbildung\label{polynomials:noise:average2nd}}
\end{figure}

Daubechies Wavelets bieten also eine komfortable Methode um verrauschte Signale
abzuleiten. Die Multiskalenanalyse kann dabei einen Kompromiss zwischen
Empfindlichkeit gegenüber Rauschen und zeitlicher Auflösung bieten.

Die Anwendung zur Ableitung kann auf der Binder Plattform im
\texttt{Ableitungen.ipynb} Notebook%
\footnote{\url{https://mybinder.org/v2/gh/rnestler/mathsem-FS2019/paper?filepath=Ableitungen.ipynb}}
nachvollzogen werden.

\section{Hochfrequente Anteile in Polynomen}
\rhead{Hochfrequente Anteile in Polynomen}

\section{Schlussfolgerung}
\rhead{Schlussfolgerung}

\printbibliography[heading=subbibliography]
\end{refsection}
