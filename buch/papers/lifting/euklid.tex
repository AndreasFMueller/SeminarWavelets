%
% euklid.tex
%
% (c) 2019 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{Der euklidische Algorithmus}
Der euklidische Algorithmus bestimmt zu zwei gegebenen Zahlen $a$ und $b$
den grössten gemeinsamen Teiler $g$.
Zusätzlich findet er ganze Zahlen $s$ und $t$ derart, dass
\[
sa + tb = g.
\]
In diesem Abschnitt soll der Algorithmus zunächst für ganze Zahlen
vorgestellt werden, bevor er auf Polynome verallgemeinert und dann
in Matrixform niedergeschrieben wird.

\subsection{Ganze Zahlen}
Gegeben sind zwei ganze Zahlen $a$ und $b$ und wir dürfen annehmen,
dass $a\ge b$.
Gesucht ist der grösste gemeinsame Teiler $g$ von $a$ und $b$.
Ist $b|a$, dann ist offenbar $b$ der grösste gemeinsame Teiler.
Im Allgemeinen wird der grösste Teiler aber kleiner sein.
Wir teilen daher $a$ durch $b$, was nur mit Rest möglich ist.
Es gibt daher Zahlen $t$ und $r$ derart, dass
\[
a = tb+ r
\qquad \Rightarrow \qquad
r = a - tb.
\]
Es ist sicher $r < b$.
Da der grösste gemeinsame Teiler sowohl $a$ als auch $b$ teilt, muss er
auch $r$ teilen.
Somit haben wir das Problem, den grössten gemeinsamen Teiler von $a$ und
$b$ zu finden auf das ``kleinere'' Problem zurückgeführt, den grössten
gemeinsamen Teiler von $b$ und $r$ zu finden.

Um den eben beschriebenen Schritt zu wiederholen, wählen wir die folgende
Notation.
Wir schreiben $a_0=a$ und $b_0=b$.
Im ersten Schritt finden wird $q_0$ und $r_0$ derart,
dass $a_0-q_0b_0 = r_0$.
Dann setzen wir $a_1=b_0$ und $b_1=r_0$.
Mit $a_1$ und $b_1$ wiederholen wir den Divisionsschritt, der Zahlen
$q_1$ und $r_1$ liefert mit $a_1-q_1b_1=r_1$.
So entstehen vier Folgen von Zahlen $a_k$, $b_k$, $q_k$ und $r_k$ derart,
dass in jedem Schritt gilt
\begin{align*}
a_k - q_kb_k &= r_k & g&|a_k & g&|b_k & a_k &= b_{k-1} & b_k = r_{k-1}
\end{align*}
Der Algorithmus bricht im Schritt $n$ ab, wenn $r_{n+1}=0$.
Der letzte nicht verschwindende Rest $r_n$ muss daher der grösste gemeinsame
Teiler sein: $g=r_n$.

\begin{beispiel}
Wir bestimmen den grössten gemeinsamen Teiler von $76415$ und $23205$
mit Hilfe des eben beschriebenen Algorithmus.
Wir schreiben die gefundenen Zahlen in eine Tabelle:
\begin{center}
\renewcommand{\arraystretch}{1.1}
\begin{tabular}{|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|}
\hline
k&  a_k&  b_k&   q_k&  r_k\\
\hline
0&76415&23205&     3&6800\\
1&23205& 6800&     3&2805\\
2& 6800& 2805&     2&1190\\
3& 2805& 1190&     2& 425\\
4& 1190&  425&     2& 340\\
5&  425&  340&     1&  85\\
6&  340&   85&     4&   0\\
\hline
\end{tabular}
\end{center}
Der Algorithmus bricht also mit dem letzten Rest $r_n=85$ ab, dies
ist der grösste gemeinsame Teiler.
\end{beispiel}

Die oben protokollierten Werte von $q_k$ werden für die Bestimmung
des grössten gemeinsamen Teilers nicht benötigt.
Wir können sie aber verwenden, um die Zahlen $s$ und $t$ zu bestimmen.

\begin{beispiel}
Wir drücken die Reste im obigen Beispiel durch die Zahlen $a_k$, $b_k$ und
$q_k$ aus und setzen sie in den Ausdruck $g=a_5-q_5b_5$ ein, bis wir
einen Ausdruck in $a_0$ und $b_0$ für $g$ finden:
\begin{align*}
r_5&=a_5-q_5 b_5=a_5-1\cdot b_5& g &= a_5 - 1 \cdot b_5 = b_4 - 1 \cdot r_4
\\
r_4&=a_4-q_4 b_4=a_4-2\cdot b_4&   &= b_4 - (a_4 -2b_4) 
                                    = -a_4 +3b_4 = -b_3 + 3r_3
\\
r_3&=a_3-q_3 b_3=a_3-2\cdot b_3&   &= -b_3 + 3(a_3-2b_3)
                                    = 3a_3 - 7b_3 = 3b_2 -7r_2
\\
r_2&=a_2-q_2 b_2=a_2-2\cdot b_2&   &= 3b_2 -7(a_2-2b_2)
                                    = -7a_2 + 17b_2 = -7b_1 + 17r_1
\\
r_1&=a_1-q_1 b_1=a_1-3\cdot b_1&   &= -7b_1 + 17(a_1-3b_1)
                                    = 17a_1 - 58b_1 = 17 b_0 - 58 r_0
\\
r_0&=a_0-q_0 b_0=a_0-3\cdot b_0&   &= 17b_0 - 58(a_0t-3b_0)
                                    = -58a_0+191b_0
\end{align*}
Tatsächlich gilt
\[
-58\cdot 76415 + 191 \cdot 23205 = 85,
\]
die Zahlen $t=-58$ und $s=191$ sind also genau die eingangs versprochenen
Faktoren.
\end{beispiel}

\subsection{Matrixschreibweise}
Die Berechnung der Zahlen $s$ und $t$ lässt sich besser verstehen, wenn
wir die Koeffizienten von $a_k$ und $b_k$ als Vektoren betrachen und
die Berechnung in Matrixschreibweise durchführen.
In jedem Schritt finden wir so einen Vektor mit Koordinaten $s_k$ und $t_k$
derart, dass das Skalarprodukt
\[
\begin{pmatrix}s_k\\t_k \end{pmatrix}
\cdot
\begin{pmatrix}a_k\\b_k \end{pmatrix}
=
g
\]
ist.

In jedem Schritt verwenden wir, dass
\[
\begin{pmatrix}
a_{k}\\b_{k}
\end{pmatrix}
=
\begin{pmatrix}
b_{k-1}\\r_{k-1}
\end{pmatrix}
=
\begin{pmatrix}
b_{k-1}\\
a_{k-1}-q_{k-1}b_{k-1}
\end{pmatrix}
=
\begin{pmatrix}
0&1\\
1&-q_{k-1}
\end{pmatrix}
\begin{pmatrix}
a_{k-1}\\b_{k-1}
\end{pmatrix}.
\]
Durch Iteration findet man daher
\[
\begin{pmatrix}
a_{n}\\b_{n}
\end{pmatrix}
=
\begin{pmatrix}
0&1\\
1&-q_{n-1}
\end{pmatrix}
\begin{pmatrix}
a_{n-1}\\b_{n-1}
\end{pmatrix}
=
\begin{pmatrix}
0&1\\
1&-q_{n-1}
\end{pmatrix}
\begin{pmatrix}
0&1\\
1&-q_{n-2}
\end{pmatrix}
\cdots
\begin{pmatrix}
0&1\\
1&-q_{0}
\end{pmatrix}
\begin{pmatrix}
a_{0}\\b_{0}
\end{pmatrix}.
\]
Der grösste gemeinsame Teiler $g$  erfüllt die Bedingung $g=a_n-q_nb_n$,
dies ist die zweite Zeile von
\[
\begin{pmatrix}
0&1\\
1&-q_n
\end{pmatrix}
\begin{pmatrix}a_n\\b_n\end{pmatrix}
=
\begin{pmatrix}
b_n\\
g
\end{pmatrix}
\]
Insbesondere kann man $g$ erhalten als Skalarprodukt des Vektors
$\begin{pmatrix}0&1\end{pmatrix}^t$ mit dem Produkt
\[
\underbrace{
\begin{pmatrix} 0&1 \\ 1&-q_n\end{pmatrix}
\begin{pmatrix} 0&1 \\ 1&-q_{n-1}\end{pmatrix}
\cdots
\begin{pmatrix} 0&1 \\ 1&-q_{0}\end{pmatrix}
}_{\displaystyle = Q_n}
\begin{pmatrix}a_0\\b_0\end{pmatrix}
=
Q \begin{pmatrix}a_0\\b_0\end{pmatrix}
\]
Das Skalarprodukt mit
$\begin{pmatrix}0&1\end{pmatrix}^t$ ist dasselbe wie die Multiplikation
von links mit dem Zeilenvektor $\begin{pmatrix}0&1\end{pmatrix}$.
Dafür ist nur die zweite Zeile von $Q$ nötig:
\[
\begin{pmatrix}0&1\end{pmatrix}
Q
=
\begin{pmatrix}0&1\end{pmatrix}
\begin{pmatrix}
*&*\\
s&t
\end{pmatrix}
\qquad\Rightarrow\qquad
g
=
\begin{pmatrix}0&1\end{pmatrix}
\begin{pmatrix}
*&*\\
s&t
\end{pmatrix}
\begin{pmatrix}a\\b\end{pmatrix}
=
ta+sb
\]
Das Matrizenprodukt enthält also in der zweiten Zeile genau die
gesuchten Zahlen $t$ und $s$.

\begin{beispiel}
Wir verifizieren die Behauptung 
\begin{align*}
Q
&=
\begin{pmatrix} 0&1 \\ 1&-q_n\end{pmatrix}
\begin{pmatrix} 0&1 \\ 1&-q_{n-1}\end{pmatrix}
\cdots
\begin{pmatrix} 0&1 \\ 1&-q_{0}\end{pmatrix}
\\
&=
\underbrace{
\begin{pmatrix} 0&1 \\ 1& -1 \end{pmatrix}
\begin{pmatrix} 0&1 \\ 1& -2 \end{pmatrix}
}_{}
\underbrace{
\begin{pmatrix} 0&1 \\ 1& -2 \end{pmatrix}
\begin{pmatrix} 0&1 \\ 1& -2 \end{pmatrix}
}_{}
\underbrace{
\begin{pmatrix} 0&1 \\ 1& -3 \end{pmatrix}
\begin{pmatrix} 0&1 \\ 1& -3 \end{pmatrix}
}_{}
\\
&=
\underbrace{
\begin{pmatrix} 1 & -2 \\ -1 &  3 \end{pmatrix}
\begin{pmatrix} 1 & -2 \\ -2 &  5 \end{pmatrix}
}_{}
\begin{pmatrix} 1 & -3 \\ -3 & 10 \end{pmatrix}
\\
&=
\begin{pmatrix} 5 & -12 \\ -7 & 17 \end{pmatrix}
\begin{pmatrix} 1 &  -3 \\ -3 & 10 \end{pmatrix}
=
\begin{pmatrix} 41 & -135 \\ -58 & 191 \end{pmatrix}.
\end{align*}
In der zweiten Zeile finden wir tatsächlich die beiden Zahlen $t=-58$ und 
$s=191$, für die wir schon früher erkannt haben, dass sie die beiden
Zahlen $a$ und $b$ linear zum grössten gemeinsamen Teiler kombinieren.

Wir können das Matrizenprodukt auch noch einen Schritt weiter treiben:
\[
\begin{pmatrix} 0 & 1 \\ 1 & -4 \end{pmatrix}
\begin{pmatrix} 41 & -135 \\ -58 & 191 \end{pmatrix}
=
\begin{pmatrix} -58 & 191 \\ 273 & -899 \end{pmatrix}
\]
In der zweiten Zeile findet man Zahlen, die $a$ und $b$ zu 0 kombinieren:
\[
273 \cdot 76415 - 899 \cdot 23205 = 0,
\]
denn dies ist die Bedingung $r_{n+1} = 0$.
\end{beispiel}

Wir fassen das Gefundene zusammen in folgendem Satz:

\begin{satz}
Seien $q_k$ die Reste, die während der Durchführung des euklidischen
Algorithmus auf den Zahlen $a$ und $b$ durchgeführten Quotienten.
Der euklidische Algorithmus berechnet dann
\[
\begin{pmatrix} 0 & 1 \\ 1 & -q_k \end{pmatrix}
\begin{pmatrix} a_k \\ b_k \end{pmatrix}
=
\begin{pmatrix} b_k \\ r_k \end{pmatrix}
=
\begin{pmatrix} r_{k-1} \\ r_k \end{pmatrix}
\]
Das Produkt dieser $2\times 2$-Matrizen erfüllt
\[
\begin{pmatrix}g\\0\end{pmatrix}
=
\begin{pmatrix}r_n\\r_{n+1}\end{pmatrix}
=
\begin{pmatrix} 0&1 \\ 1&-q_n\end{pmatrix}
\begin{pmatrix} 0&1 \\ 1&-q_{n-1}\end{pmatrix}
\cdots
\begin{pmatrix} 0&1 \\ 1&-q_{0}\end{pmatrix}
\begin{pmatrix}a\\b\end{pmatrix}
=
Q_n
\begin{pmatrix}a\\b\end{pmatrix}
\]
\end{satz}

Die Wirkung der Matrix
\[
Q(q) = \begin{pmatrix} 0 & 1 \\ 1 & -q \end{pmatrix}
\]
lässt sich mit genau einer Multiplikation und einer Addition
berechnen.
Dies ist die Art von Matrix, die wir für die Implementation der
Wavelet-Transformation anstreben.

\subsection{Polynome}
Der Ring $\mathbb{Q}[X]$ der Polynome in der Variablen $X$ mit rationalen
Koeffizienten verhält
sich bezüglich Teilbarkeit ganz genau gleich wie die ganzen Zahlen.
Insbesondere ist der euklidische Algorithmus genauso wie die
Matrixschreibweise auch für Polynome durchführbar.

\begin{beispiel}
Wir berechnen als Beispiel den grössten gemeinsamen Teiler 
der Polynome
\[
a = X^4 - 2X^3 -7 X^2 + 8X + 12,
\qquad
b = X^4 + X^3 -7X^2 -X + 6.
\]
Wir erstellen wieder die Tabelle der Reste
\begin{center}
\renewcommand{\arraystretch}{1.4}
\begin{tabular}{|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|>{$}r<{$}|}
\hline
k&  a_k&  b_k&   q_k&  r_k\\
\hline
0& X^4 - 2X^3 -7 X^2 + 8X + 12& X^4 + X^3 -7X^2 -X + 6&       1&-3X^3+9X+6\\
1&X^4+X^3-7X^2-X+6            &-3X^3+9X+6             &-\frac13X-\frac13&-4X^2+4X+8\\
2&-3X^3+9X+6      &-4X^2+4X+8& \frac34 X + \frac34& 0\\
\hline
\end{tabular}
\end{center}
Daraus kann man ablesen, dass $-4x^2+4x+8$ grösster gemeinsamer Teiler ist.
Normiert auf einen führenden Koeffizienten $1$ ist dies das Polynom
$x^2-x+2=(x+2)(x-1)$.

Wir berechnen auch noch die Polynome $s$ und $t$.
Dazu müssen wir die Matrizen $Q(q_k)$ miteinander multiplizieren:
\begin{align*}
Q
&=Q(q_2) Q(q_1) Q(q_0)
\\
&=
\begin{pmatrix} 0 & 1 \\ 1 & -\frac34(X+1) \end{pmatrix}
\begin{pmatrix} 0 & 1 \\ 1 & \frac13(X+1) \end{pmatrix}
\begin{pmatrix} 0 & 1 \\ 1 & -1 \end{pmatrix}
\\
&=
%                        [     x   1         2   x    ]
%                        [     - + -         - - -    ]
%                        [     3   3         3   3    ]
%(%o22)                  [                            ]
%                        [     2            2         ]
%                        [    x     x   3  x    x   3 ]
%                        [ (- --) - - + -  -- - - - - ]
%                        [    4     2   4  4    4   2 ]
\begin{pmatrix}
\frac13(X+1)&-\frac13(X-2)\\
-\frac14(X^2+2X-3)&\frac14(X^2-X-6)
\end{pmatrix}.
\end{align*}
In der ersten Zeile finden wir die Polynome $t(X)$ und $s(X)$, mit denen
\begin{align*}
ta+sb
&=
\frac13(X+1)
(X^4-2X^3-7X^2+8X+12)
-\frac13(X-2)
(X^4+X^3-7X^2-X+6)
\\
&=
-4X^2+4X+8
\end{align*}
und dies ist tatsächlich der gefundene grösste gemeinsame Teiler.
Die zweite Zeile von $Q$ gibt uns die Polynomfaktoren, mit denen
$a$ und $b$ gleich werden:
\begin{align*}
q_{21}a+q_{22}b
&=
-\frac14(X^2+2X-3)
(X^4-2X^3-7X^2+8X+12)
+\frac14(X^2-X-6)
(X^4+X^3-7X^2-X+6)
\\
&=0.
\qedhere
\end{align*}
Man kann natürlich den grössten gemeinsamen Teiler auch mit Hilfe einer
Faktorisierung der Polynome $a$ und $b$ finden:
\begin{align*}
a  &=         (X-3) (X-2)\phantom{(X-1)}(X+1)         (X+2) \phantom{(X+3)}\\
b  &=\phantom{(X-3)}(X-2)         (X-1) (X+1)\phantom{(X+2)}         (X+3) \\
g  &=\phantom{(X-3)}(X-2)\phantom{(X-1)}(X+1)\phantom{(X+2)}\phantom{(X+3)}
    = X^2 -X + 2\\
v=a/g&=         (X-3)\phantom{(X-2)(X-1)(X+1)} (X+2) \phantom{(X+3)}
    = X^2-X-6 \\
u=b/g&=\phantom{(X-3)(X-2)} (X-1)\phantom{(X+1)(X+2)}(X+3)
    = X^2+2X-3
\end{align*}
Aus den letzten zwei Zeilen folgt
$ua-vb = ab/g - ab/g = 0$, wie erwartet.
\end{beispiel}


