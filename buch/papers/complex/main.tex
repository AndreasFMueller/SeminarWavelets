%
% main.tex -- Paper zum Thema komplexe Morlet Wavelets und CWT
%
% (c) 2019 Hochschule Rapperswil
%

\chapter{Komplexe Wavelets und CWT\label{chapter:complex}}
\lhead{Komplexe Wavelets und CWT}
\begin{refsection}
\chapterauthor{Roy Seitz}

% \section{Einleitung}
Die diskrete Wavelet-Transformation (DWT) mit reellen Wavelets ist besonders schnell zu berechnen.
Deshalb ist sie die bevorzugte Wahl zur Signalverarbeitung.
In der Analyse und beim Erstellen `schöner' Bilder trifft man indes, unter anderem, auf folgende drei Probleme:

Erstens wäre es für Bilder vorteilhaft, die relevanten Frequenzpunkte vorgeben zu können.
So kann man direkt lineare oder logarithmische Skalen wählen. Die DWT ist jedoch an Zweierpotenzen gebunden. %TODO: Referenz zum Frame für a^n statt 2^n
Zweitens erfordern die meisten Methoden zum Erstellen von Bildern ein reguläres Raster.
Die DWT liefert aber in jeder zusätzlichen Zeile nur noch halb so viele Punkte.
Drittens ist es, wenn man Schwingungen finden möchte, vorteilhaft, wenn die Amplitude ersichtlich ist.
Sie kann beispielsweise als Helligkeit abgebildet werden. 
Bei reellen Wavelets sind Amplitude und Phase jedoch nicht einfach zu trennen.

Die CWT aus Kapitel~\ref{chapter:cwt} ist die bevorzugte Wahl für analytische Berechnungen.
Als kontinuierliche Transformation benötigt sie jedoch etwas Vorarbeit,
nämlich eine Diskretisierung der $a$- und $b$-Variablen.
Eine anschliessende direkte Berechnung der diskretisierten Integrale ist sehr rechenintensiv.
Im ersten Abschnitt betrachten wir deshalb, wie man die CWT als Faltung interpretieren kann, welche sich effizient mittels FFT berechnen lässt.
Zur Illustration verwenden wir zwei einfache Beispielsignale und die CWT mittels Haar-Wavelet.

Die Wahl des Wavelets spielt eine zentrale Rolle und beeinflusst das erhaltene Bild wesentlich.
Ein wichtiger Punkt ist hierbei die Unschärfe-Relation zwischen Zeit und Frequenz.
Ein Signal kann nicht in beidem zugleich gut lokalisiert sein.
Deshalb betrachten wir als Vergleich noch die CWT mittels Gabor-Wavelet.

Im zweiten Abschnitt wenden wir uns der Separation von Phase und Amplitude zu.
Wir definieren einen Operator $\Ana\,$, welcher uns ein passendes Wavelet erzeugt.
Wir werden sehen, dass die Hilberttransformation uns immer erlaubt, zu einem reellen Wavelet einen Imaginärteil zu finden,
so dass das erhaltene, komplexe Wavelet eine Separierung von Phase und Amplitude erlaubt.

Als drittes betrachten wir die Artefakte, die durch die Berechnung der CWT mittels FFT entstehen.
Sie sind der zirkulären Faltung geschuldet.
Geschickte Erweiterung des Signals kann diesen Effekt reduzieren.
Im dritten Abschnitt vergleichen wir deshalb die erzielten Bilder mit verschiedenen Padding-Optionen.

Am Schluss betrachten wir noch ein paar weitere, interessante Bilder und sehen uns an, was die Wavelettransformation liefert.
Für die Bilder werden wir in diesem Kapitel immer wieder komplexe, zweidimensionale Signale abbilden müssen.
Dazu verwenden wir die Farbcodierung aus Abbildung~\ref{complex:color-code}.
Auch die rein reellen, zweidimensionalen Bilder werden so abgebildet.
Bei reellen Bildern sind dann eben nur Blau und Gelb vorhanden.

\begin{figure}
	\centering
	\includegraphics{papers/complex/images/colors.pdf}
	\caption{Farb-Code für komplexe Signale. Die Farbe steht für das Argument, die Helligkeit codiert den Betrag.}
	\label{complex:color-code}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{papers/complex/cwt.tex}
\input{papers/complex/gabor.tex}
\input{papers/complex/negative.tex}

\input{papers/complex/analytic.tex}
\input{papers/complex/haar.tex}

\input{papers/complex/padding.tex}

\section{Zusammenfassung und abschliessende Beispiele}
\rhead{Schlussfolgerung}
\input{papers/complex/schluss.tex}

\printbibliography[heading=subbibliography]
\end{refsection}
