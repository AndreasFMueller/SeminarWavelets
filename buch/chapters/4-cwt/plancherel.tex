%
% plancherel.tex
%
% (c) 2019 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{Plancherel-Formel%
\label{section:cwt:plancherel}}
\rhead{Plancherel-Formel}
Die Plancherel-Formel der Fourier-Theorie besagt, dass die
Fourier-Transformation eine Isometrie ist.
Das Skalarprodukt zweier Funktionen und das Skalarprodukt der
Fourier-Transformierten ist dasselbe.
Daraus folgt unmittelbar, dass die Transformation stetig und
umkehrbar ist.
Es ist daher erstrebenswert, wenn eine ähnliche Formel auch
auch für die stetige Wavelet-Transformation gilt.

\subsection{Das Skalarprodukt auf $H$}
Der Definnitionsbereich $H=\mathbb R^* \times \mathbb R$ der
Wavelet-Transformierten kan auf verschiedene Arten mit einer Integration
ausgestattet werden.
Wir versuchen das ``richtige'' Mass zu erraten, im
Abschnitt~\ref{subsection:haar-mass} werden wir eine abstrakte Begründung
geben.

Die Variable $b$ verhält sich genau wie die Variable $t$ bei Integration
einer Funktion von $t$.
Funktionen werden durch den Parameter $b$ verschoben, dabei darf sich
das Integral nicht ändern.
Das ist genau die Eigenschaft, mit deren Hilfe das Lebesgue-Mass
definiert wurde.

Die Variable $a$ funktioniert dagegen als Skalierungsparameter.
Grössere Werte von $a$ ziehen den Träger des Integranden um den Faktor $a$ 
in die Länge.

\begin{definition}
\label{cwt:definition:plancherel}
Das Mass auf $H$ ist definiert duch das Integral
\[
\int_H F(a,b)\,db \,\frac{da}{a^2}
\]
und das Skalaprodukt von Funktionen auf $H$ ist
\[
\langle F,G\rangle_H
=
\int_{H} F(a,b)\overline{G(a,b)}\,db \,\frac{da}{a^2}.
\]
\end{definition}

Dieses Mass ist im folgenden Sinn das richtige Mass.
Wenden wir auf die Argumente einer Funktion auf $H$ die Transformation
\[
(a,b) \mapsto (\alpha a, \beta + \alpha b)
\]
an, ändert sich das Integral wie folgt:
\begin{align*}
\int_H F(\alpha a,\beta + \alpha b)\,d(\beta + \alpha b)\,\alpha\frac{da}{|\alpha a|^2}
&=
\int_H F(\alpha a,\beta + \alpha b) \alpha\,db \ \frac{da}{|a|^2},
\end{align*}
die Transformation der Funktion ändert also das Integral nicht.
Die Wahl des Integrals ist so, dass die Skalierung und Translation
das Integral nicht ändert.

\subsection{Die Abhängigkeit von $b$}
Die partielle Funktion $b\mapsto \mathcal{W}f(a,b)$ ist etwas einfacher
zu verstehen, wir versuchen sie daher zunächst für konstantes $a$
anders auszudrücken.
Da die Wavelet-Transformierte ein Skalarprodukt in $L^2(\mathbb R)$
ist, können wir die Plancherel-Formel für die Fouriertransformation
verwenden und erhalten.
\[
\mathcal{W}f (a,b)
=
\langle f,\psi_{a,b} \rangle
=
\langle \hat{f}, \hat{\psi}_{a,b}\rangle.
\]
Die Fouriertransformierte von $\psi_{a,b}$ ist aber bereits bekannt,
sie ist
\[
\hat{\psi}_{a,b}(\omega)
=
e^{-i\omega b} \hat{\psi}_a(\omega)
=
\sqrt{|a|}e^{-i\omega b} \hat{\psi}(a\omega).
\]
Damit kann jetzt die Wavelet-Transformierte als Skalarprodukt im
Frequenzraum geschrieben werden:
\begin{align*}
\mathcal{W}f (a,b)
&=
\int_{-\infty}^\infty 
\hat{f}(\omega)
\sqrt{|a|}e^{i\omega b} \overline{\hat{\psi}(a\omega)}
\,d\omega
=
\int_{-\infty}^\infty
\bigl(
\sqrt{|a|}
\hat{f}(\omega)
\overline{\hat{\psi}(a\omega)}
\bigr)
e^{i\omega b}
\,d\omega
\\
&=
\frac1{\sqrt{2\pi}}
\int_{-\infty}^\infty
\underbrace{
\sqrt{2\pi}
\sqrt{|a|}
\hat{f}(\omega)
\overline{\hat{\psi}(a\omega)}}_{\displaystyle F_a(\omega)}
e^{i\omega b}
\,d\omega
\end{align*}
Daraus kann man ablesen, dass $F_a(\omega)$ die Fourier-Umkehrtransformierte
der Funktion $b\mapsto \mathcal{W}f(a,b)$ ist.
Bezeichnen wir die Fourier-Umkehrtransformierte mit dem umgekehrten
Dach über dem Funktionsbuchstaben,
dann folgt
\begin{equation}
\check{F}_a(b) = \mathcal{W}f(a, b)
\label{cwt:checkF}
\end{equation}

\subsection{Die Plancherel-Formel}
Ziel dieses Abschnitts ist, in Satz~\ref{satz:wplancherel} die
Plancherel-Formel für die Wavelet-Transformation zu beweisen.
Wir wollen diesen Beweis auf die Plancherel-Formel für die 
Fourier-Transformation stützen, die bereits die Formel~\eqref{cwt:checkF}
für die $b$-Abhängigkeit geliefert hat.
Wir werden natürlich wieder die Funktion $F_a(\omega)$ benötigen.
Da die Plancherel-Formel das Skalarprodukt zweier Funktionen berechnet,
werden wir eine zweite Funktion $g$ bezeichnen, die zugehörige, analog
zu $F_a(\omega)$ gebildete Funktion wird mit $G_a(\omega)$ bezeichnet,
es ist
\[
G_a(\omega)
=
\sqrt{2\pi}\sqrt{|a|}
\hat{g}(\omega)
\overline{\hat{\psi}(a\omega)}.
\]
Damit sind wir jetzt in der Lage, die Plancherel-Formel zu beweisen:

\begin{satz}
\label{satz:wplancherel}
Sei $\psi$ ein Wavelet mit der Konstanten $C_{\psi}$, wie sie in
der Zulässigkeitsbedingung auftritt.
Dann gilt
\begin{equation}
\langle \mathcal{W}f,\mathcal{W}g\rangle
=
C_{\psi}\langle f,g\rangle
\end{equation}
für beliebige Funktionen $f,g\in L^2$.
\end{satz}

\begin{proof}[Beweis]
Wir verwenden 
\begin{align}
\langle \mathcal{W}f, \mathcal{W}g\rangle_H
&=
\int_{\mathbb R^*} \int_{-\infty}^\infty
\mathcal{W}f (a,b)
\overline{\mathcal{W}g (a,b)} \,db \,\frac{da}{|a|^2}
\notag
\\
&=
\int_{\mathbb R^*} \int_{-\infty}^\infty
\hat{F}_a(b) \overline{\hat{G}_a(b)}\,db\,\frac{da}{|a|^2}
\notag
\\
&=
\int_{\mathbb R^*} 
\langle
\check{F}_a,\check{G}_a
\rangle
\,\frac{da}{|a|^2}
\notag
\\
&=
\int_{\mathbb R^*} \langle F_a, G_a\rangle \,\frac{da}{|a|^2}
\notag
\\
&=
\int_{\mathbb R^*}
\int_{-\infty}^\infty
2\pi |a|\hat{f}(\omega) \overline{\hat{g}(\omega)} |\hat{\psi}(a\omega)|^2
\,d\omega
\,\frac{da}{|a|^2}
\notag
\\
&=
\int_{-\infty}^\infty
\hat{f}(\omega) \overline{\hat{g}(\omega)}
\underbrace{
2\pi
\int_{\mathbb R^*}
|\hat{\psi}(a\omega)|^2
\,\frac{da}{|a|}}_{\displaystyle=C_\psi}
\,d\omega.
\label{cwtplancherel:p1}
\end{align}
Das Produkt $\hat{f}(\omega)\overline{\hat{g}(\omega)}$ deutet darauf hin,
dass dies fast schon ein Skalarprodukt ist.
Es wird tatsächlich das Skalarprodukt, wenn das innere Integral konstant ist.
Wir betrachten dieses separat und setzen $a\omega = s$, was
\begin{align*}
\int_{\mathbb R^*} |\hat{\psi}(a\omega)|^2 \,\frac{da}{|a|}
&=
\int_{\mathbb R^*} |\hat{\psi}(s)|^2 \,\frac{ds/\omega}{|s/\omega|}
=
\int_{\mathbb R^*} |\hat{\psi}(s)|^2 \,\frac{ds}{|s|}
=
\frac{C_{\psi}}{2\pi}
\end{align*}
ergibt.
Eingesetzt \eqref{cwtplancherel:p1} finden wir
\begin{align*}
\langle \mathcal{W}f, \mathcal{W}g\rangle_H
&=
C_{\psi}
\int_{-\infty}^\infty \hat{f}(\omega)\overline{\hat{g}(\omega)}\,d\omega
=
C_{\psi}
\langle \hat{f},\hat{g}\rangle
=
C_{\psi}
\langle f,g\rangle.
\end{align*}
Damit ist die Plancherel-Formel bewiesen.
\end{proof}

Mit dem Satz~\ref{satz:wplancherel} wird jetzt klar, warum die
Zulässigkeitsbedingung so wichtig ist.
Die Zulässigkeitsbedingung ist genau das was wir brauchen um zu schliessen,
dass die stetige Wavelet-Transformation stetig ist.
Aus dem Satz folgt, dass
\[
\| \mathcal{W}f \|_H = \sqrt{C_{\psi}}\|f\|.
\]
Es ist also nicht möglich, dass eine Funktion $f\ne 0$ eine verschwindende
Wavelet-Transformation hat.
Anders ausgedrückt: verschiedene Funktionen lassen sich immer auch anhand
ihrer Wavelet-Transformation unterscheiden.

\subsection{Das Haar-Mass auf $\mathbb R^* \ltimes \mathbb R$
\label{subsection:haar-mass}}
Das Lebesgue-Mass auf $\mathbb R$ zeichnet sich dadurch aus, dass
die Translation einer Funktion ein Integral nicht ändert:
\[
\int_{\mathbb R} T_bf(t)\,dt
=
\int_{\mathbb R} f(t-b)\,dt
=
\int_{\mathbb R} f(t)\,dt.
\]
Diese Eigenschaft kann man auch in anderen Definitionsbereichen antreffen.
Zum Beispiel ändert sich das Integral
\[
\int_0^\infty f(t)\,\frac{dt}{t}
\]
auch nicht, wenn die Funktio $f$ durch $\tilde{D}_af$ ersetzt wird
für $a>0$.
Die Substition $\tau = t/a$ im Integral
\begin{align*}
\int_0^\infty \tilde{D}_af(t)\,\frac{dt}{t}
&=
\int_0^\infty f(t/a)\,\frac{dt}{t}
=
\int_0^\infty f(\tau) \frac{a d\tau}{a\tau}
=
\int_0^\infty f(\tau) \frac{d\tau}{\tau}
\end{align*}
zeigt dies.
So wie $\mathbb R$ abgeschlossen ist bezüglich der Addition ist die Menge
$\mathbb R^+=\{x\in\mathbb R\;|\; x > 0\}$ abgeschlossen unter Multiplikation.

Diese Beboachtung lässt sich weitgehend verallgemeinern.
Eine {\em Gruppe} ist eine Menge mit einer assoziativen Operation, einem
bezüglich der Operation neutralen Element, und so, dass jedes Element
invertierbar ist.
Die Menge $\mathbb R$ ist eine Gruppe bezüglich der Addition mit dem neutralem
Element $0$ und dem inversen Element $-x$ zu jedem $x\in\mathbb R$.
Für die Menge $\mathbb R^+$ mit der Multipliation als Operation ist
$1$ das neutrale Element und das inverse Element von $x\in\mathbb R^+$
ist $x^{-}$.
Die beiden Beispiel zeigen, dass es unter gewissen Voraussetzungen
möglich ist, für Funktionen auf einer Gruppe $G$ ein Integral zu definieren,
welches unverändert bleibt, wenn man die Funktion $f:G\to \mathbb C$ 
durch die Funktion $(g\cdot f)(x) = f(g\cdot x)$ ersetzt, also
\[
\int_G (g\cdot f)(x)\,d\mu(x)
=
\int_G f(x)\,d\mu(x).
\]
Die Existenz eines solchen Masses ist nicht trivial und wurde
von Alfréd Haar 1933 bewiesen. 
\index{Alfréd Haar}
Es wird heutzutage {\em Haarsches Mass} genannt.
\index{Haar Mass}

Die Menge $H=\mathbb R^*\times \mathbb R$ ist eine Gruppe mit der
Gruppenoperation
\[
(a_1,b_1)\cdot (a_2,b_2) = (a_1a_2,a_1b_2+b_1),
\]
dem neutralen Element $(1,0)$ und dem inversen Element
\[
(a,b)^{-1} = (a^{-1}, -a^{-1}b)
\qquad\text{denn}\qquad
\left\{
\begin{aligned}
(a,b)\cdot (a^{-1},-a^{-1}b)
&=
(aa^{-1},b-aa^{-1}b)=(1,0)
\\
(a^{-1},-a^{-1}b)\cdot (a,b)
&=
(a^{-1}a,-a^{-1}b-a^{-1}b)=(1,0).
\end{aligned}
\right.
\]
Die Gruppe $H$ wird auch $H=\mathbb R^*\times \mathbb R$ geschrieben
und heisst das semidirekte Produkt der Gruppen $\mathbb R^*$ mit der
Multiplikation als Gruppenoperation und $\mathbb R$ mit der Addition
als Gruppenoperation.
Nach Haar müsste es also auch ein Haarsches Mass auf $H$ geben.

$H$ enthält zwei Gruppen, für die wir das Haarsche Mass schon kennen.
Für $\mathbb R$ ist es das gewöhnliche Lebesgue-Integral, für $\mathbb R^*$
ist es ein Integral mit einem Faktor $1/x$.
Man kann daher vermuten, dass das Haar-Integral von der Form
\[
\int_H f(a,b) \,\frac{da}{m(a)}\,db
\]
sein muss.

Wenden wir die Operation des Gruppen-Elements $(\alpha,\beta)\in H$
auf die Funktion $f$ an und verwenden die Substitution
$\tilde{a}=\alpha a$ und $\tilde{b}=\alpha b$
\begin{align*}
\int_H f(\alpha a,\beta-\alpha b) \,\frac{da}{m(a)}\,db
&=
\int_H f(\tilde{a}, \beta - \tilde b) \,
d\tilde{b}/\alpha\,\frac{d\tilde{a}/\alpha}{m(a)}
\\
&=
\int_H f(\tilde{a}, \beta - \tilde b) \,
d\tilde{b}\,\frac{d\tilde{a}}{\alpha^2m(a)}
\\
&=
\int_H f(\tilde{a}, \beta) \,
d\tilde{b}\,\frac{d\tilde{a}}{\alpha^2m(a)}.
\end{align*}
Das Integral ändert sich genau dann nicht, wenn
\[
\alpha^2 m(a)
=
m(\tilde{a})
=
m(\alpha a)
\qquad\Rightarrow\qquad
m(a) = a^2.
\]
Dies ist genau das in der Definition~\ref{cwt:definition:plancherel}
des Skalarproduktes für die stetige Wavelettransformation verwendete
Integral.





