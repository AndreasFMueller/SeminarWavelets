%
% faltung.tex
%
% (c) 2019 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{Faltung
\label{section:faltung}}
\rhead{Faltung}
Die Faltung kann dazu verwendet werden, neue Kandidatenfunktionen
für Wavelets zu erzeugen.
Dazu müssen wir verstehen, wie die Faltung und die Operatoren $T_b$ und
$D_a$ zusammenwirken.
Wir erinnern an die Definition~\ref{definition:faltung} und die
Formel \eqref{definition:formel:faltung}
\[
(f*g)(t)
=
\int_{-\infty}^\infty f(s)g(t-s)\,ds
\]
für die Faltung.

\subsection{Faltung als Skalarprodukt}
\index{Faltung als Skalarprodukt}%
Die Faltung ist ein Integral über ein Produkt von Funktionen.
Kann man sie als Skalarprodukt schreiben, welches ebenfalls ein Integral
über ein Produkt von Funktionen ist?
Leider hat die Integrationsvariable im Faktor $g(t-s)$ das falsche
Vorzeichen, die Funktion ist ``verkehrt''.
Wir korrigieren dies mit Hilfe zweier Operator, die wie folgt
definiert sind.

\begin{definition}
Die Operatoren $C$ und $R$ wirken auf eine Funktion $f(t)$ mittels
\begin{align*}
&\text{Konjugation:}
&(Cf)(t) &= \bar{f}(t)&
&\text{und}&
&\text{``Umkehrung''}&
(Rf)(t) = \bar{f}(-t).
\end{align*}
$C$ heisst der {\em Konjugationsoperator} oder auch einfach die
{\em Konjugation}.
$R$ heisst {\em Umkehrungsoperator} (engl.~{\em Reversing operator}).
\end{definition}
\index{Konjugationsoperato}%
\index{Umkehrungsoperator}%
\index{Reversing operator}%

Offenbar sind sowohl $R$ also auch $C$  Isometrien von $L^2(\mathbb R)$.
$R$ lässt sich aus einem Spezialfall des Skalierungsoperators aufbauen:
$R=CD_{-1}$.
Selbstverständlich vertauscht $C$ mit allen Operatoren $T_b$ und $D_a$,
da er auf die Werte wirkt, währen $T_b$ und $D_a$ auf die Argumente
wirken.
Daraus ergeben sich automatisch die Rechenregeln
\[
T_bR = RT_b = CT_{-b}
\qquad\text{und}\qquad
D_aR = CD_{-a}=RD_a.
\]

Mit Hilfe des Operators $R$ lässt sich die Faltung jetzt als
Skalarprodukt schreiben.
Es ist nämlich
\begin{align*}
(f*g)(t)
&=
\int_{-\infty}^\infty f(s) g(t-s) \,ds
=
\int_{-\infty}^\infty f(s) \overline{(Rg)(s-t)} \,ds
=
\int_{-\infty}^\infty f(s) \overline{(T_tRg)(s)} \,ds
=
\langle f,T_tRg\rangle.
\end{align*}
Mit dieser Schreibweise lässt sich das Zusammenspiel zwischen Faltung
und den Operatoren $T_b$ und $D_a$ viel leichter verstehen.

\subsection{Faltung und die Translations- und Dilatationsoperatoren
\label{subsection:translation-und-dialatation}}
Mit Hilfe der Darstellung als Skalarprodukt können wir jetzt sofort
die Faltung von translierten oder skalierten Funktionen ermitteln.

Wir beginnen mit der Faltung der Translate $T_bf$ und $T_cg$:
\begin{align*}
(T_bf * T_cg)(t)
&=
\langle T_bf, T_tRT_cg\rangle
=
\langle T_bf, T_tT_{-c}Rg\rangle
=
\langle f, T_{-b}T_tT_{-c}Rg\rangle
\\
&=
\langle f, T_{-b+t-c}Rg\rangle
=
T_{b+c}
\langle f, T_tRg\rangle
=
T_{b+c}(f*g)(t).
\end{align*}
Wir formulieren dieses Resultat als

\begin{satz}
Für beliebige Funktionen $f,g\in L^2(\mathbb R)$ gilt
\begin{equation}
T_bf*T_cg
=
T_{b+c}(f*g).
\label{eq:Tconv}
\end{equation}
\end{satz}

In ganz ähnlicher Weise können wir auch die Faltung von
$D_af$ und $D_ag$ bestimmen:
\begin{align*}
(D_af * D_ag)(t)
&=
\langle D_af, T_tRD_ag\rangle
=
\langle D_af, T_tD_aRg\rangle
=
\langle D_af, D_aT_{t/a}Rg\rangle
\\
&=
\langle f, T_{t/a}Rg\rangle
=
\sqrt{|a|} D_a \langle f, T_t Rg\rangle
=
\sqrt{|a|}(D_a (f*g))(t).
\end{align*}
In der Skalierungsrelation einer Multiskalenanalyse kommen keine
gemischten Skalierungsfaktoren $a$ vor, daher reicht die Form
\eqref{eq:Dconv} für die nachfolgenden Rechnung aus.
Für gemischte Skalierungsfaktoren lässt sich keine Formel angeben,
wie in Übungsaufgabe~1 dieses Kapitels gezeigt wird.

\begin{satz}
\label{satz:faltung:Da}
Für beliebige Funktionen $f,g\in L^2(\mathbb R)$ gilt
\begin{align}
D_af * D_ag &= \sqrt{|a|}D_a(f*g)
&&\text{und}
&
\tilde{D}_af * \tilde{D}_ag &= a\tilde{D}_a(f*g).
\label{eq:Dconv}
\end{align}
für $a>0$.
\end{satz}

\begin{proof}[Beweis]
Wir müssen nur noch die zweite Formel für den Operator $\tilde{D}_a$
nachweisen.
Dazu verwenden wir die Relation $D_af = \sqrt{|a|}\tilde{D}_a$ und die
erste Beziehung in \eqref{eq:Dconv} und erhalten
\[
\tilde{D}_af * \tilde{D}_ag
=
\sqrt{|a|}D_af * \sqrt{|a|}D_ag
=
|a|
\sqrt{|a|}
D_a (f*g)
=
|a|
\tilde{D}_a(f*g).
\]
Damit ist auch die zweite Relation bewiesen.
\end{proof}


\subsection{Linearkombinationen
\label{subsection:linearkombinationen}}
Ein wesentlicher Aspekt einer Multiskalenanalyse ist, dass das
Vaterwavelet $\varphi$ eine Linearkombination von skalierten
Translaten $D_{\frac12}T_k\varphi$ des Vaterwavelets ist.
Wir vereinfachen die manchmal etwas umständlichen Formeln für
die Skalierungsrelationen etwas, indem wir auf beiden Seiten
den Operator $D_2$ anwenden.
Dies führt auf die folgende Definition.

\begin{definition}
Wir sagen, eine Funktion $f$ erfüllt die {\em Skalierungseigenschaft},
wenn es Koeffizienten $f_k$ gibt derart, dass
\[
D_2f = \sum_{k\in\mathbb Z} f_k T_kf
\]
\end{definition}

\begin{satz}
\label{satz:faltung-linearkombination}
Sind $f$ und $g$ Funktionen, die beide die Skalierungseigenschaft
mit Koeffizienten $f_k$ und $g_l$
haben, dann hat auch $h=f*g$ die Skalierungseigenschaft
mit Koeffizienten
\begin{equation}
h_s = \frac1{\sqrt{2}} \sum_{k+l=s}f_kg_l.
\label{eq:faltung-linearkombination}
\end{equation}
\end{satz}

\begin{proof}[Beweis]
Seien $f_k$ und $g_k$ die Koeffizienten der Skalierungsrelation von $f$
bzw.~$g$, also
\begin{align*}
D_2f
&=
\sum_{k\in\mathbb Z} f_k T_kf
&
&\text{und}&
D_2g
&=
\sum_{k\in\mathbb Z} g_k T_kg.
\end{align*}
Nach \eqref{eq:Dconv} ist die Faltung der Funktionen $D_2f$ und $D_2g$
gegeben durch
\[
D_2f * D_2g
=
\sqrt{2}
D_2(f*g)
=
\sqrt{2}
D_2h.
\]
Andererseits können wir auch die Faltung der Linearkombinationen 
berechnen:
\begin{align*}
D_2f * D_2g
&=
\biggl( \sum_{k\in\mathbb Z} f_kT_kf \biggr)
*
\biggl( \sum_{l\in\mathbb Z} g_lT_lg \biggr)
\\
&=
\sum_{s\in\mathbb Z}
\sum_{k+l=s} f_kg_l T_kf * T_lg
=
\sum_{s\in\mathbb Z}
\sum_{k+l=s} f_kg_l T_{k+l}(f * g)
=
\sum_{s\in\mathbb Z}
\biggl(\sum_{k+l=s} f_kg_l\biggr) T_sh.
\end{align*}
Es folgt, dass
\[
D_2h
=
\frac1{\sqrt{2}} D_2f * D_2g
=
\sum_{s\in\mathbb Z}
\biggl(\frac1{\sqrt{2}}\sum_{k+l=s} f_kg_l\biggr) T_sh.
\]
Dies ist eine Skalierungsrelation für die Funktion $h$, die Koeffizienten
sind
\[
h_s = \frac1{\sqrt{2}} \sum_{k+l=s}f_kg_l.
\]
Damit ist alles bewiesen.
\end{proof}

\subsection{Faltung im Frequenzbereich
\label{subsection:faltung-im-frequenzbereich}}
Wir können dieses Resultat auch im Frequenzbereich formulieren.
Wir haben im Abschnitt~\ref{section:skalfour} die Skalierungsrelation
für die Fourier-Transformierte $\hat{\varphi}$ von $\varphi$ mit Hilfe
der erzeugenden Funktion
\[
H(\omega)
=
\frac{1}{\sqrt{2}}
\sum_{k\in\mathbb Z} h_ke^{-ik\omega}
\]
(siehe Definition~\ref{definition:erzeugende-funktion-msa})
als
\begin{equation}
\hat{\varphi}(\omega)
=
H\biggl(\frac{\omega}2\biggr)
\,
\hat{\varphi}\biggl(\frac{\omega}2\biggr)
\label{faltung:skalierung}
\end{equation}
geschrieben.
Sind
$(\varphi_1,H_1)$ und $(\varphi_2,H_2)$ zwei Paare von Funktionen,
welche beide die Skalierungsrelation~\eqref{faltung:skalierung} erfüllen,
dann folgt
\begin{align*}
%\hat{\varphi}_1(\omega)
%&=
%H_1\biggl(\frac{\omega}2\biggr)
%\hat{\varphi}_1 \biggl(\frac{\omega}2\biggr)
%&&\wedge&
%\hat{\varphi}_1(\omega)
%=
%H_1\biggl(\frac{\omega}2\biggr)
%\hat{\varphi}_1\biggl(\frac{\omega}2\biggr)
%&&\Rightarrow&
\hat{\varphi}_1(\omega)
\cdot
\hat{\varphi}_2(\omega)
&=
H_1\biggl(\frac{\omega}2\biggr)
\cdot
H_2\biggl(\frac{\omega}2\biggr)
\cdot
\hat{\varphi}_1\biggl(\frac{\omega}2\biggr)
\cdot
\hat{\varphi}_2\biggl(\frac{\omega}2\biggr)
\\
%&&&&
%&\Rightarrow&
\Rightarrow\qquad
\widehat{\mathstrut\varphi_1*\varphi_2}(\omega)
&=
H_1\biggl(\frac{\omega}2\biggr)
H_2\biggl(\frac{\omega}2\biggr)
\,
\widehat{\mathstrut\varphi_1*\varphi_2}\biggl(\frac{\omega}2\biggr).
\end{align*}
In der zweiten Zeile haben wir den gemeinsamen Faktor $\sqrt{2\pi}$
auf beiden Seiten weggelassen.
Die Faltung $\varphi_1*\varphi_2$ erfüllt also die Skalierungsrelation
mit der erzeugenden Funktion $H_1\cdot H_2$, die wegen
\[
H_1(\omega)\,H_2(\omega)
=
\frac{1}{\sqrt{2}}
\sum_{k\in\mathbb Z} h_{1,k}e^{-ik\omega}
\cdot
\frac{1}{\sqrt{2}}
\sum_{l\in\mathbb Z} h_{2,l}e^{-il\omega}
=
\frac{1}{\sqrt{2}}
\sum_{s\in\mathbb Z} e^{-is\omega}
\frac{1}{\sqrt{2}}
\sum_{k+l=s}h_{1,k}h_{2,l}
\]
die Koeffizienten
\[
h_s = \frac{1}{\sqrt{2}}\sum_{k+l=s} h_{1,k}h_{2,l}
\]
hat,
wie bereits im Satz~\ref{satz:faltung-linearkombination} gezeigt worden ist.

