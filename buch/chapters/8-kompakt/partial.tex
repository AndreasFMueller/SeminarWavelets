%
% partial.tex -- 
%
% (c) 2019 Prof Dr Andreas Müller, Hochschule Rapperswil
%

\section{Partialbruchzerlegung\label{section:partialbruch}}
\rhead{Partialbruchzerlegung}
Es muss ein Polynom $P(y)$ gefunden werden mit der Eigenschaft, dass
\begin{equation}
y^N P(1-y) + (1-y)^N P(y) = 1.
\label{buch:kompakt:bedingung}
\end{equation}
Division durch $y^N(1-y)^N$ macht daraus
\[
Q(y)
=
\frac{1}{y^N(1-y)^N}
=
\frac{P(1-y)}{(1-y)^N}
+
\frac{P(y)}{y^N}
\]
Die beiden Terme auf der rechten Seite sind rationale Funktionen, die im
Nenner ausschliesslich Potenzen von $1-y$ im ersten und $y$ im zweiten
Term haben.
Dies sind genau die Nenner, die man in der Partialbruchzerlegung der linken
Seite findet.

Wir berechnen daher die Partialbruchzerlegung
\begin{equation}
\frac{1}{y^N(1-y)^N}
=
\sum_{k=1}^N\frac{C_k}{y^k}
+
\sum_{k=1}^N\frac{C'_k}{(1-y)^k}
\label{buch:kompakt:pbruch}
\end{equation}
von $Q(y)$.
Der Ausdruck $Q(y)$ ist symmetrisch bezüglich bezüglich der Abbildung
$y\leftrightarrow 1-y$.
Da die Koeffizienten der Partialbruchzerlegung eindeutig bestimmt sind,
müssen die Koeffizienten der beiden Summen in \eqref{buch:kompakt:pbruch}
übereinstimmen: $C'_k=C_k$ für $k=1,\dots,N$.

Multipliziert man \eqref{buch:kompakt:pbruch} wieder mit $y^N(1-y)^N$,
erhält man
\begin{align*}
1
&=
(1-y)^N
\underbrace{\sum_{k=1}^\infty C_k y^{N-k}}_{\displaystyle =P(y)}
\mathstrut
+
y^N
\sum_{k=1}^\infty C_k (1-y)^{N-k}
\\
&=
(1-y)^N
P_N(y)
+
y^N
P_N(1-y).
\end{align*}
Das Polynom $P_N(y)$, gebildet mit den Koeffizienten der Partialbruchzerlegung
von $Q(y)$ löst also das eingangs gestellte Problem.

\subsection{Die Fälle $N=2$ und $N=3$}
Wir berechnen die Partialbruchzerlegung für kleine Werte von $N$.
Für $N=2$ ist
\begin{align*}
\frac{1}{y^2(1-y)^2}
&=
\frac{C_1}{y}
+
\frac{C_2}{y^2}
+
\frac{C_1}{(1-y)}
+
\frac{C_2}{(1-y)^2}
\\
&=
\frac{C_1y+C_2}{y^2}
+
\frac{C_1(1-y)+C_2}{(1-y)^2}
\\
&=
\frac{1}{y^2(1-y)^2}
\bigl(
(C_1y+C_2)(1-2y+y^2)
+
(C_1+C_2-C_1y)y^2
\bigr)
\intertext{oder nach Multiplikation mit $y^N(1-y)^N$}
1
&=
C_2
+
(C_1-2C_2) y
+
(C_2-2C_1) y^2
+
C_1 y^3
+
(C_1+C_2)y^2
-C_1y^3
\\
&=
C_2 + (C_1-2C_2) y + (2C_2-C_1)y^2.
\end{align*}
Durch Koeffizientenvergleich findet man die Bedingungen
\[
\begin{aligned}
C_2&=1,
&
C_1-2C_2&=0
&&
\text{und}
&
2C_2-C_1&=0.
\end{aligned}
\]
Die dritte Bedingung ist identisch mit der zweiten.
Aus der ersten und der zweiten Bedingung folgt $C_1=2$.
Es folgt
\[
P_2(y) = C_1y + C_2
=
2y+1.
\]

Die analoge Rechnung für $N=3$ liefert die Bedingungen
\[
\begin{aligned}
C_3&=1
\\
C_2-3C_3&=0     &&\Rightarrow&C_2&=3C_3=3
\\
3C_3-3C_2+C_1&=0&&\Rightarrow&C_1&=3C_2-3C_3=6
\\
4C_2-2C_1&=0    &&\Rightarrow&C_1&=2C_2=6
\\
C_1-2C_2&=0     &&\Rightarrow&C_1&=2C_2=6
\end{aligned}
\]
Man liest daraus das Polynom
\[
P_3(y) = 1+3y+6y^2
\]
ab.
Auf die gleiche Weise findet man auch
\begin{align*}
P_4(y) &=
1 + 4y + 10y^2 + 20y^3
\end{align*}
Daraus kann man die Vermutung ablesen, dass
\begin{equation}
P_N(y)
=
\sum_{k=0}^{N-1}
\binom{N+k-1}{k}
y^k
\label{buch:kompakt:vermutung}
\end{equation}
sein könnte.

\subsection{Der allgemeine Fall}
Das Polynom $P_N(y)$ ist die einzige Lösung vom Grad $N-1$ der Gleichung
$
(1-y)^NP(y)+y^NP(1-y)=1.
$
Die Bedingung ist gleichbedeutend mit
\begin{equation}
P(y) = (1-y)^{-N} (1-y^NP(y)).
\label{buch:kompakt:produkt}
\end{equation}
Das Ziel dieses Abschnitts ist, $P_N(y)$ explizit zu bestimmen.

Um mehr über $P_N(y)$ herauszufinden, können wir beide Seiten von
\eqref{buch:kompakt:produkt} in Taylor-Reihen um den Punkt $y=0$
entwickeln.
Da wir nur ein Polynom vom Grad $N-1$ suchen, können wir die Taylor-Reihen
nach $y^{N-1}$ abbrechen.
Der Ausdruck $y^Np(y)$ auf der rechten Seite von \eqref{buch:kompakt:produkt}
enthält nur Terme vom Grad mindestens $N$ in $y$,
für die Terme vom Grad $<N$ spielt er daher keine Rolle.
Eine Lösung vom Grad $N-1$ erhält man daher, indem man die Reihe
für $(1-y)^{-N}$ nach dem Terme vom Grade $N-1$ abbricht.

Auf der rechten Seite von \eqref{buch:kompakt:produkt}
kann man die Newtonsche Potenzreihe
\begin{equation*}
(1-y)^{\alpha} = \sum_{k=0}^{\infty} \binom{\alpha}{k} (-y)^k
\end{equation*}
verwenden.
Im vorliegenden Fall ist $\alpha=-N$ und damit sind die Koeffizienten
\begin{align*}
\binom{-N}{k}
&=
\frac{(-N)\cdot(-N-1)\cdot\dots\cdot (-N-k+1)}{k\cdot (k-1)\cdot\dots\cdot 1}
=
(-1)^k \frac{N\cdot(N+1)\cdot\dots\cdots (N+k-1)}{k\cdot(k-1)\cdot\dots\cdot 1}
\\
&=
(-1)^k \binom{N+k-1}{k}.
\end{align*}
Daraus können wir das Polynom $P_N(y)$ ablesen.
Wegen $(-y)^k(-1)^k=y^k$ folgt das folgende Lemma,
welches auch die Vermutung \eqref{buch:kompakt:vermutung} bestätigt.

\begin{lemma}
\label{buch:kompakt:lemma-partial}
Das Polynom
\begin{equation}
P_N(y) = \sum_{k=0}^{N-1} \binom{N+k-1}{k}y^k,
\end{equation}
ist das einzige Polynom vom Grad $N$, welches die Gleichung
\[
(1-y)^NP_N(y) + y^NP_N(1-y)=1
\]
erfüllt.
\end{lemma}

\subsection{Weitere Lösungen von höherem Grad}
Das Polynom $P_N(y)$ ist nicht die einzige Lösung der Gleichung
\eqref{buch:kompakt:bedingung}.
Weitere Lösungen $P(y)$ haben aber notwendigerweise Grad mindestens $N$.
Die Differenz $D(y) = P(y)-P_N(y)$ erfüllt die Bedingung
\[
(1-y)^N D(y) + y^N D(1-y) = 0
\qquad\Leftrightarrow\qquad
(1-y)^N D(y) = -y^N D(y-1).
\]
Die rechte Seite hat eine $N$-fache Nullstelle bei $y=0$, also muss
$D(y)$ ebenfalls eine $N$-fache Nullstelle haben. 
Der term niedrigsten Grades in $D(y)$ hat daher mindestens den Grad $N$.
Wir schreiben daher $D(y) = y^NR(y)$.

Damit die Bedingung \eqref{buch:kompakt:bedingung} erfüllt ist, muss
für $R(y)$ die Bedingung
\[
(1-y)^N
D(y)
=
(1-y)^N
y^N
R(y)
=
-y^N
(1-y)^N
R(1-y)
\qquad\Rightarrow\qquad
R(y) = -R(1-y)
\]
erfüllt sein.
Es genügt daher, dass $R(y)$ ein Polynom ist, welches bezüglich $y=\frac12$
antisymmetrisch ist.

\begin{lemma}
Eine beliebige Lösung $P(y)$ der Gleichung 
\[
(1-y)^N P(y) + y^N P(1-y)=1
\]
hat die Form
\[
P(y) = P_N(y) + y^N R(y),
\]
wobei $R(y)$ ein bezüglich $y=\frac12$ antisymmetrisches Polynom ist,
also $R(1-y)=-R(y)$.
\end{lemma}



