%
% umkehrformel.tex
%
% (c) 2019 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\begin{frame}
\frametitle{Umkehrformel für $\mathbb R^n$}
Gegeben: $\mathcal{B}=\{\vec{b}_1,\dots,\vec{b}_n\}\subset\mathbb R^n$
orthonormierte Basis, d.~h.
\[
\langle \vec{b}_j,\vec{b}_i\rangle = \delta_{ji}
\]
\uncover<2->{%
Koordinaten eines Vektors $\vec{v}$ in der Basis
\[
	v_i = \langle \vec{v},\vec{b}_i\rangle
\]
}
\uncover<3->{%
Rekonstruktion:
\[
\vec{w}
=
\sum_{j=1}^{n} v_j\vec{b}_j
\uncover<4->{%
=
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle \vec{b}_j}
\]
}
\uncover<5->{%
Verifikation: $\vec{w}$ hat die gleichen Koordinaten wie $\vec{v}$
\begin{align*}
\uncover<6->{\langle \vec{w},\vec{b}_i\rangle}
&\uncover<7->{=\biggl\langle
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle\vec{b}_j, \vec{b}_i
\biggr\rangle}
\uncover<8->{=
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle \langle \vec{b}_j,\vec{b}_i\rangle}
\uncover<9->{=
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle \delta_{ji}}
\uncover<10->{=
\langle \vec{v},\vec{b}_i\rangle}
\uncover<11->{\quad{\color{red}\checkmark}}
\end{align*}
}

\end{frame}

%
% Vermutung für Umkehrformel für CWT
%
\begin{frame}
\frametitle{Umkehrformel für CWT}
\begin{cwt}
Wavelet-Transformierte von $f\in L^2(\mathbb R)$:
\[
\mathcal{W}f(a,b)
=
\frac{1}{\sqrt{|a|}}
\int_{-\infty}^\infty f(t) \overline{\psi\biggl(\frac{t-b}{a}\biggr)} \,dt
\uncover<2->{=
\langle f,\psi_{a,b}\rangle}
\]
\end{cwt}
\uncover<3->{%
Analyse mit
\begin{itemize}
\item<4->
$L^2$-Skalarprodukt
\item<5->
``Basis'': $T_bD_a \psi = \psi_{a,b}$
\end{itemize}
}
\uncover<6->{%
\begin{umkehrformel}
\ifthenelse{\boolean{presentation}}{
\only<6>{%
Für $\vec{v}\in \mathbb R^n$ mit Basis
$\mathcal{B}=\{\vec{b}_1,\dots,\vec{b}_n\}$
}
\only<7>{%
Für $f\in L^2$ mit Basis
$\mathcal{B}=\{\vec{b}_1,\dots,\vec{b}_n\}$
}
\only<8-13>{%
Für $f\in L^2$ mit ``Basis''
$\psi_{a,b}$:
}
\only<14->{für $\mathcal{W}f(a,b)$:\phantom{$L^2$ mit ``Basis''}}
\[
\only<6>{
\vec{v}=\sum_{j=1}^\infty \langle \vec{v},\vec{b}_j\rangle\,\vec{b}_j
}
\only<7>{
f=\sum_{j=1}^\infty \langle f,\vec{b}_j\rangle\, \vec{b}_j
}
\only<8>{
f=\sum_{a,b}^{\phantom{\infty}} \langle f,\psi_{a,b}\rangle\, \psi_{a,b}
}
\only<9>{
f=\sum_{a,b}^{\phantom{\infty}} \mathcal{W}f(a,b)\,\psi_{a,b}
}
\only<10>{
f(t)=\sum_{a,b}^{\phantom{\infty}} \mathcal{W}f(a,b)\,\psi_{a,b}(t)
}
\only<11>{
f(t)=\sum_{a}^{\phantom{\infty}} \int_{-\infty}^\infty \mathcal{W}f(a,b)\,\psi_{a,b}(t)\, db
}
\only<12>{
f(t)=\int_{\mathbb R^+} \int_{-\infty}^\infty \mathcal{W}f(a,b)\psi_{a,b}(t)\, db \,da
}
\only<13>{
f(t)=\int_{\mathbb R^+} \int_{-\infty}^\infty \mathcal{W}f(a,b)\psi_{a,b}(t)\, db \,\frac{da}{|a|^2}
}
\only<14>{
f(t)
\stackrel{{\color{red}?}}{=}
\int_{\mathbb R^+} \int_{-\infty}^\infty \mathcal{W}f(a,b)\psi_{a,b}(t)\, db \,\frac{da}{|a|^2}
}
\]}{
\[
f(t)
\stackrel{{\color{red}?}}{=}
\int_{\mathbb R^+} \int_{-\infty}^\infty \mathcal{W}f(a,b)\psi_{a,b}(t)\, db \,\frac{da}{|a|^2}
\]
}
\end{umkehrformel}
}
\end{frame}

%
% Verifikation der Umkehrformel
%
\begin{frame}
\frametitle{Vergleichsprinzip}

\begin{vergleich}
Für zwei Funktionen $f_1$ und $f_2$ in $L^2(\mathbb R)$ gilt
\[
\left.
\begin{aligned}
f_1&=f_2
&&\Leftrightarrow&
\langle f_1,g\rangle &= \langle f_2,g\rangle
\\
f_1-f_2&=0
&&\Leftrightarrow&
\langle f_1-f_2,g\rangle &= 0
\end{aligned}
\quad\right\}
\quad
\text{für alle $g\in L^2(\mathbb R)$}
\]
\end{vergleich}
\vspace*{-10pt}

\begin{proof}[Beweis]
Richtung $\boxed{\Rightarrow}$\;: Verwende Cauchy-Schwarz-Ungleichung
\begin{align*}
f_1&=f_2
&&\Rightarrow&
f_1-f_2&=0
&&\Rightarrow&
|\langle f_1-f_2,g\rangle|
&\le
\underbrace{\|f_1-f_2\|}_{\displaystyle=0}\cdot \|g\|
\end{align*}
\vspace{-20pt}

Richtung $\boxed{\Leftarrow}$\;: Verwende $g=f_1-f_2$
\begin{align*}
\langle f_1-f_2,g\rangle&=0
&&\Rightarrow&
\|f_1-f_2\|
&=
\langle f_1-f_2,f_1-f_2\rangle
=
0
&&\Rightarrow&
f_1-f_2&=0
\end{align*}
\end{proof}

\end{frame}

%
% Verifikation der Umkehrformel
%
\begin{frame}
\frametitle{Verifikation der Umkehrformel $\mathbb R^n$}
Umkehrformel muss gleiche Skalarprodukte mit $\vec{w}$ haben wie $\vec{v}$:
\[
\langle \vec{v},\vec{w}\rangle
\stackrel{?}{=}
\langle \text{Umkehrformel für $\vec{v}$},\vec{w}\rangle
\qquad\text{für alle $\vec{w}\in\mathbb R^n$}
\]
\uncover<2->{
Nachrechnen
\begin{align*}
&\hbox to8cm{\hfill}\\[-20pt]
\langle\vec{v},\vec{w}\rangle
&\stackrel{?}{=}
\ifthenelse{\boolean{presentation}}{
\only<3>{
\biggl\langle
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle\,\vec{b}_j,\vec{w}
\biggr\rangle
}
\only<4>{
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle\,\langle\vec{b}_j,\vec{w}\rangle
}
\only<5>{
\sum_{j=1}^n \langle \vec{v},\vec{b}_j\rangle\,
\overline{\langle\vec{w},\vec{b}_j\rangle}
}
\only<6->{
\sum_{j=1}^n v_j\bar{w}_j
}
\only<7->{
\qquad\text{Parseval-/Plancherel-Formel}
}}{
\sum_{j=1}^n v_j\bar{w}_j
\qquad\text{Parseval-/Plancherel-Formel}
}
\end{align*}
\uncover<8->{%
\begin{parseval}
$f,g$ $2\pi$-periodische Formeln mit Fourierkoeffizienten 
$a_k^f,a_k^g$ und $b_k^f,b_k^g$, dann gilt
\vspace{-10pt}

\[
\langle f,g\rangle
=
\frac12
a_0^f \overline{a_0^g}
+
\sum_{k=1}^\infty
(
a_k^f \overline{a_k^g}
+
b_k^f \overline{b_k^g}
)
\]
\end{parseval}}
}
\vspace*{-10pt}
\uncover<9->{%
\begin{plancherel}
Für $f,g\in L^2(\mathbb R)$ gilt
\[
\langle f, g\rangle
=
\langle \mathcal{F}f,\mathcal{F}g\rangle
=
\langle \hat{f},\hat{g}\rangle
\]
\end{plancherel}}

\end{frame}

%
% Verifikation der Umkehrformel
%
\begin{frame}
\frametitle{Verifikation der Umkehrformel $\mathcal{W}f$}

Umkehrformel muss gleiche Skalarprodukte mit $g$ haben wie $f$:
\[
\langle f,g\rangle
\stackrel{?}{=}
\langle \text{Umkehrformel für $f$},g\rangle
\qquad\text{für alle $g\in L^2$}
\]
\uncover<2->{
Nachrechnen
\begin{align*}
&\hbox to8cm{\hfill}\\[-20pt]
\langle f, g\rangle
&
\stackrel{?}{=}
\ifthenelse{\boolean{presentation}}{
\only<3>{
\biggl\langle
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)\,\psi_{a,b}
\, db\,\frac{da}{|a|^2},
g
\biggr\rangle}
\only<4>{
\int_{-\infty}^\infty
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)\,\psi_{a,b}(t)
\, db\,\frac{da}{|a|^2}
\,
\overline{g(t)}
\,dt
}
\only<5>{
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)
\int_{-\infty}^\infty
\psi_{a,b}(t)
\,
\overline{g(t)}
\,dt
\, db\,\frac{da}{|a|^2}
}
\only<6>{
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)
\langle
\psi_{a,b},
g
\rangle
\, db\,\frac{da}{|a|^2}
}
\only<7>{
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)
\overline{
\langle
g,
\psi_{a,b}
\rangle}
\, db\,\frac{da}{|a|^2}
}
\only<8-10>{
\int_{\mathbb R^+}\int_{-\infty}^\infty
\mathcal{W}f(a,b)
\overline{\mathcal{W}g(a,b)}
\, db\,\frac{da}{|a|^2}}
\only<11->{
\langle 
\mathcal{W}f(a,b),
\mathcal{W}g(a,b)
\rangle_H}
\only<12->{\qquad\text{Plancherel-Formel}}}{
\langle 
\mathcal{W}f(a,b),
\mathcal{W}g(a,b)
\rangle_H
\qquad\text{Plancherel-Formel}
}
\end{align*}
}

\uncover<9->{
\begin{definition}
Die Menge $H=\{(a,b)\,|\, a\in\mathbb R^*\wedge b\in\mathbb R\}$
heisst die {\em Heisenberg-Gruppe}.
\uncover<10->{%
Für Funktionen auf $H$ gilt das Skalarprodukt
\[
\langle u,v\rangle_H
=
\int_{\mathbb R^*}\int_{-\infty}^\infty
u(a,b)\overline{v(a,b)}
\,db\,\frac{da}{|a|^2}
\]
}
\end{definition}
}

\end{frame}

\input{beweis.tex}

%%
%% Resultate
%%
%\begin{frame}
%\frametitle{Resultate}
%\begin{zulaessig}
%Eine Funktion $\psi\in L^2(\mathbb R)$ mit $\|\psi\|=1$ ist zulässig,
%wenn
%\[
%C_{\psi}
%=
%2\pi
%\int_{\mathbb R^*} \frac{|\hat{\psi}(a\omega)|^2}{|a|}\,da < \infty
%\uncover<4->{%
%\quad\Rightarrow\quad
%\hat{\psi}(0)=0
%\quad\Rightarrow\quad
%\int_{-\infty}^\infty \psi(t)\,dt = 0
%}
%\]
%\uncover<2->{%
%Gilt zum Beispiel für differenzierbare Wavelets mit kompaktem Träger.
%}
%\end{zulaessig}
%
%\uncover<3->{%
%\begin{umkehrformelW}
%Für $f\in L^2(\mathbb R)$ gilt
%\[
%\mathring{f}(t)
%=
%\frac{1}{C_\psi}
%\int_{\mathbb R^*}\int_{-\infty}^\infty \mathcal{W}f(a,b)\,\psi_{a,b}(t)\,db\,\frac{da}{|a|^2}
%\uncover<4->{
%\quad\Rightarrow\quad
%\langle\mathring{f},g\rangle = \langle f,g\rangle
%\quad\forall g\in L^2(\mathbb R)
%}
%\]
%\uncover<5->{Unter zusätzlichen ``Regularitätsbedingungen'':
%$\mathring{f}(t)=f(t)$}
%\end{umkehrformelW}}
%
%\end{frame}

\input{resultate.tex}
